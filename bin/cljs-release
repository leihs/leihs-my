#!/bin/bash -eu

MY_DIR="$(dirname ${BASH_SOURCE})/.."
cd "${MY_DIR}"
echo "PWD: $PWD"

# add our clojure version to the path
source $MY_DIR/shared-clj/clojure/bin/activate

npm ci
# HINT if you ever run into js problems with release resp advanced optimization
# add the `--debug` option, this does tree shaking but keeps the original name
# references, e.g. :
# npx shadow-cljs release leihs-my-js --debug
npx shadow-cljs release leihs-my-js
rm -rf resources/all/public/my/js/cljs-runtime/

cd -

# vi: ft=sh
