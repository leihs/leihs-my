name: 'Build my uberjar'

include:
  - path: cider-ci/install-ruby_task-component.yml
    submodule: [leihs-ui]

git_options:
  submodules:
    include_match: ^.*$

environment_variables:
  CI: 'true'

traits:
  Docker Engine: true

max_trials: 5

scripts:
  build-my-uberjar:
    timeout: 60 minutes
    exclusive_executor_resource: leihs-my-jar-docker-build_{{CIDER_CI_TREE_ID}}
    start_when:
      install-ruby-passed: { script_key: install-ruby }
    body: |
      USE_DOCKER=YES ${LEIHS_MY_DIR}/bin/build
