depends_on: &GOOD_TO_MERGE_DEPENDENTS
  my-build-uberjar was successful:
    type: job
    job_key: my-build-uberjar
    states: [passed]
  specs have passed:
    type: job
    job_key: specs
    states: [passed]
  ui-checks were successful:
    type: job
    job_key: ui-checks
    states: [passed]
  lints were successful:
    type: job
    job_key: lint
    states: [passed]
  database merged to master:
    job_key: merged-to-master
    type: job
    submodule: [database]
    states: [passed]
  shared-clj merged to master:
    job_key: merged-to-master
    type: job
    submodule: [shared-clj]
    states: [passed]
run_when: *GOOD_TO_MERGE_DEPENDENTS
priority: 999 # "empty" job = high priority
context:
  task_defaults:
    max_trials: 1
  tasks:
    all relevant tests have passed:
      name: "All relevant tests have passed, thus good to merge"
      scripts:
        main:
          body: echo 'All relevant tests have passed' ; exit 0
